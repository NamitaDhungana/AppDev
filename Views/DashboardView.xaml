<UserControl x:Class="JournalApp.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:viewmodels="clr-namespace:JournalApp.ViewModels"
             xmlns:helpers="clr-namespace:JournalApp.Helpers"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
             d:DataContext="{d:DesignInstance Type=viewmodels:DashboardViewModel}"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="False" Margin="0,0,0,24">
            <TextBlock Text="Insights &amp; Analytics" Style="{DynamicResource MaterialDesignHeadline4TextBlock}" DockPanel.Dock="Left"/>
            
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" VerticalAlignment="Center">
                <DatePicker SelectedDate="{Binding ExportStartDate}" materialDesign:HintAssist.Hint="Export From" Width="130" Margin="0,0,12,0" Style="{DynamicResource MaterialDesignFloatingHintDatePicker}"/>
                <DatePicker SelectedDate="{Binding ExportEndDate}" materialDesign:HintAssist.Hint="Export To" Width="130" Margin="0,0,12,0" Style="{DynamicResource MaterialDesignFloatingHintDatePicker}"/>
                <Button Content="EXPORT PDF" Command="{Binding ExportPdfCommand}" Style="{DynamicResource MaterialDesignRaisedButton}" Margin="8,8,0,0"/>
            </StackPanel>
        </DockPanel>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Quick Entry Today (Requested) -->
                <materialDesign:Card Margin="8,0,8,16" Padding="16" UniformCornerRadius="8" Background="{DynamicResource PrimaryHueLightBrush}" Foreground="{DynamicResource PrimaryHueLightForegroundBrush}">
                    <StackPanel>
                        <TextBlock Text="Quick Journal Today" Style="{DynamicResource MaterialDesignHeadline5TextBlock}" Margin="0,0,0,16"/>
                        
                        <TextBox Text="{Binding QuickTitle, UpdateSourceTrigger=PropertyChanged}" 
                                 materialDesign:HintAssist.Hint="Title for today..." 
                                 Style="{DynamicResource MaterialDesignFloatingHintTextBox}" 
                                 Margin="0,0,0,8" FontSize="18"/>

                        <materialDesign:Card Padding="12" Margin="0,8,0,0" Background="{DynamicResource MaterialDesignPaper}">
                            <DockPanel MinHeight="250">
                                <!-- Editor Toolbar -->
                                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,8">
                                    <Button Click="FormatBold_Click" Style="{DynamicResource MaterialDesignFlatButton}" Width="40" Padding="0" ToolTip="Bold">
                                        <materialDesign:PackIcon Kind="FormatBold" Width="20" Height="20"/>
                                    </Button>
                                    <Button Click="FormatItalic_Click" Style="{DynamicResource MaterialDesignFlatButton}" Width="40" Padding="0" ToolTip="Italic">
                                        <materialDesign:PackIcon Kind="FormatItalic" Width="20" Height="20"/>
                                    </Button>
                                    <Button Click="FormatBullets_Click" Style="{DynamicResource MaterialDesignFlatButton}" Width="40" Padding="0" ToolTip="Bullet List">
                                        <materialDesign:PackIcon Kind="FormatListBulleted" Width="20" Height="20"/>
                                    </Button>
                                    <Button Click="FormatHeading_Click" Style="{DynamicResource MaterialDesignFlatButton}" Width="40" Padding="0" ToolTip="Heading">
                                        <materialDesign:PackIcon Kind="FormatHeaderPound" Width="20" Height="20"/>
                                    </Button>
                                    <Button Click="FormatLink_Click" Style="{DynamicResource MaterialDesignFlatButton}" Width="40" Padding="0" ToolTip="Insert Link">
                                        <materialDesign:PackIcon Kind="Link" Width="20" Height="20"/>
                                    </Button>
                                    <Separator Style="{DynamicResource MaterialDesignLightSeparator}" Margin="8,0"/>
                                    <TextBlock Text="Live Visual Editor" VerticalAlignment="Center" Opacity="0.5" FontStyle="Italic" Margin="8,0"/>
                                </StackPanel>

                                <RichTextBox x:Name="QuickEditor"
                                             helpers:RichTextHelper.DocumentXaml="{Binding QuickContent, UpdateSourceTrigger=PropertyChanged}"
                                             materialDesign:HintAssist.Hint="Write your thoughts here..."
                                             Style="{DynamicResource MaterialDesignRichTextBox}"
                                             BorderThickness="1"
                                             BorderBrush="{DynamicResource MaterialDesignDivider}"
                                             VerticalScrollBarVisibility="Auto"
                                             MinHeight="200"
                                             FontSize="16">
                                    <RichTextBox.Resources>
                                        <Style TargetType="{x:Type Paragraph}">
                                            <Setter Property="Margin" Value="0"/>
                                        </Style>
                                    </RichTextBox.Resources>
                                </RichTextBox>
                            </DockPanel>
                        </materialDesign:Card>

                        <Button Content="SAVE TODAY'S ENTRY" 
                                Command="{Binding SaveQuickEntryCommand}" 
                                Margin="0,16,0,0" 
                                HorizontalAlignment="Right" 
                                Style="{DynamicResource MaterialDesignRaisedAccentButton}"/>
                    </StackPanel>
                </materialDesign:Card>
                <!-- Visual Analytics -->
                <Grid Margin="8,0,8,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Activity Chart -->
                    <materialDesign:Card Margin="0,0,8,0" Padding="16" UniformCornerRadius="8">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="200"/>
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                <materialDesign:PackIcon Kind="ChartBar" Width="24" Height="24" Foreground="{DynamicResource PrimaryHueMidBrush}" Margin="0,0,8,0"/>
                                <TextBlock Text="Activity Trend (Last 7 Days)" Style="{DynamicResource MaterialDesignHeadline6TextBlock}"/>
                            </StackPanel>
                            
                            <lvc:CartesianChart Grid.Row="1" Series="{Binding ActivitySeries}" XAxes="{Binding ActivityXAxes}" TooltipPosition="Top">
                            </lvc:CartesianChart>
                        </Grid>
                    </materialDesign:Card>

                    <!-- Mood Chart -->
                    <materialDesign:Card Grid.Column="1" Padding="16" UniformCornerRadius="8">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="200"/>
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                <materialDesign:PackIcon Kind="ChartPie" Width="24" Height="24" Foreground="{DynamicResource PrimaryHueMidBrush}" Margin="0,0,8,0"/>
                                <TextBlock Text="Moods" Style="{DynamicResource MaterialDesignHeadline6TextBlock}"/>
                            </StackPanel>

                            <lvc:PieChart Grid.Row="1" Series="{Binding MoodSeries}" LegendPosition="Right" TooltipPosition="Top"/>
                        </Grid>
                    </materialDesign:Card>
                </Grid>

                <UniformGrid Columns="3" VerticalAlignment="Top" Margin="8,0">
                    <materialDesign:Card Margin="8" Padding="16">
                        <StackPanel HorizontalAlignment="Center">
                            <materialDesign:PackIcon Kind="Fire" Width="32" Height="32" Foreground="#FFFF8000" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding CurrentStreak}" Style="{DynamicResource MaterialDesignHeadline4TextBlock}" HorizontalAlignment="Center"/>
                            <TextBlock Text="Current Streak" Opacity="0.6" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Margin="8" Padding="16">
                        <StackPanel HorizontalAlignment="Center">
                            <materialDesign:PackIcon Kind="Trophy" Width="32" Height="32" Foreground="#FFFFD700" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding LongestStreak}" Style="{DynamicResource MaterialDesignHeadline4TextBlock}" HorizontalAlignment="Center"/>
                            <TextBlock Text="Longest Streak" Opacity="0.6" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Margin="8" Padding="16">
                        <StackPanel HorizontalAlignment="Center">
                            <materialDesign:PackIcon Kind="Notebook" Width="32" Height="32" Foreground="#FF2196F3" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding AvgWords}" Style="{DynamicResource MaterialDesignHeadline4TextBlock}" HorizontalAlignment="Center"/>
                            <TextBlock Text="Avg Words/Day" Opacity="0.6" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </materialDesign:Card>
                </UniformGrid>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
